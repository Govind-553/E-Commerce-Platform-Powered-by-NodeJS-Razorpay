<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>My Profile - Cartify</title>
    <link rel="icon" type="image/png" href="/img/profile-picture.png">
    <link rel="stylesheet" href="/styles/profile.css" />
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
    <nav class="navbar" role="navigation" aria-label="Main navigation">
        <a href="/" class="brand" aria-label="Cartify home">CARTIFY</a>
        <button class="btn-outline" onclick="logout()">Logout</button>
    </nav>

    <div class="container" role="main">
        <div class="header">
            <h1>My Dashboard</h1>
        </div>

        <div class="card user-info" aria-labelledby="userName">
            <div class="avatar" id="avatarDisplay" aria-hidden="false">U</div>

            <div class="info">
                <div class="top-row">
                    <div class="info-left">
                        <h2 id="userName">Loading...</h2>
                        <p id="userEmail">...</p>
                        <p id="userPhone" style="font-size: 0.9rem; margin-top: 6px;">...</p>
                        <p id="userAddress" style="font-size: 0.9rem;">...</p>
                    </div>
                    <div style="display:flex; align-items:center;">
                        <button class="edit-btn" onclick="toggleEditProfile()" aria-expanded="false" id="editToggleBtn">Edit Profile</button>
                    </div>
                </div>

                <!-- Edit Profile Form -->
                <div id="editProfileForm" aria-hidden="true">
                    <div class="form-grid" role="form" aria-label="Edit profile fields">
                        <input type="text" id="editName" placeholder="Full Name" aria-label="Full Name">
                        <input type="text" id="editPhone" placeholder="Phone Number" aria-label="Phone Number">
                        <input type="text" id="editAddress" placeholder="Address" style="grid-column: span 2;" aria-label="Address">
                    </div>
                    <div class="form-actions">
                        <button onclick="saveProfile()" class="btn-primary" id="saveProfileBtn">Save Changes</button>
                        <button onclick="toggleEditProfile()" class="btn-cancel" id="cancelProfileBtn">Cancel</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Activity Chart -->
        <div class="card">
            <h3 style="margin-top:0;">My Activity</h3>
            <div class="chart-wrap">
                <canvas id="activityChart" role="img" aria-label="Order status chart"></canvas>
            </div>
        </div>

        <div class="card orders">
            <h3>Recent Orders</h3>
            <div id="orderList" aria-live="polite">
                <p style="color: var(--muted); text-align: center;">Loading orders...</p>
            </div>
        </div>
    </div>

    <!-- Firebase SDKs -->
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-auth-compat.js"></script>
    <script src="/js/firebaseConfig.js"></script>
    <script src="/js/toast.js"></script>
    <script src="/js/config.js"></script>

    <script src="/js/profile.js"></script>
</body>
</html>
